<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Cheap Numerical Integration through Data points.</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body><div class="container">

<table width="100%" summary="page for integrate.xy {sfsmisc}"><tr><td>integrate.xy {sfsmisc}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Cheap Numerical Integration through Data points.</h2>

<h3>Description</h3>

<p>Given <i>(x_i, f_i)</i> where <i>f_i = f(x_i)</i>, compute a cheap
approximation of <i>integral(a .. b) f(x) dx</i>.
</p>


<h3>Usage</h3>

<pre>
integrate.xy(x, fx, a, b, use.spline=TRUE, xtol=2e-08)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>x</code></td>
<td>
<p>abscissa values.</p>
</td></tr>
<tr valign="top"><td><code>fx</code></td>
<td>
<p>corresponding values of <i>f(x)</i>.</p>
</td></tr>
<tr valign="top"><td><code>a,b</code></td>
<td>
<p>the boundaries of integration; these default to min(x) and
max(x) respectively.</p>
</td></tr>
<tr valign="top"><td><code>use.spline</code></td>
<td>
<p>logical; if TRUE use an interpolating spline.</p>
</td></tr>
<tr valign="top"><td><code>xtol</code></td>
<td>
<p>tolerance factor, typically around
<code>sqrt(.Machine$double.eps)</code> ......(fixme)....</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Note that this is really not good for noisy <code>fx</code> values;
probably a smoothing spline should be used in that case.
</p>
<p>Also, we are not yet using Romberg in order to improve the trapezoid
rule.  This would be quite an improvement in equidistant cases.
</p>


<h3>Value</h3>

<p>the approximate integral.
</p>


<h3>Author(s)</h3>

<p>Martin Maechler, May 1994 (for S).</p>


<h3>See Also</h3>

<p><code><a href="../../stats/html/integrate.html">integrate</a></code> for numerical integration of
<em>functions</em>.</p>


<h3>Examples</h3>

<pre>
 x &lt;- 1:4
 integrate.xy(x, exp(x))
 print(exp(4) - exp(1), digits = 10) # the true integral

 for(n in c(10, 20,50,100, 200)) {
   x &lt;- seq(1,4, len = n)
   cat(formatC(n,wid=4), formatC(integrate.xy(x, exp(x)), dig = 9),"\n")
 }
</pre>

<hr /><div style="text-align: center;">[Package <em>sfsmisc</em> version 1.1-12 <a href="00Index.html">Index</a>]</div>
</div></body></html>
