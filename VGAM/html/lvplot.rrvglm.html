<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Latent Variable Plot for RR-VGLMs</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for lvplot.rrvglm {VGAM}"><tr><td>lvplot.rrvglm {VGAM}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2> Latent Variable Plot for RR-VGLMs </h2>

<h3>Description</h3>

<p>Produces an <em>ordination diagram</em> (also known as a <em>biplot</em> or
<em>latent variable plot</em>) for <em>reduced-rank vector generalized
linear models</em> (RR-VGLMs).  For rank-2 models only, the x- and y-axis
are the first and second canonical axes respectively.
</p>


<h3>Usage</h3>

<pre>
lvplot.rrvglm(object,
              A = TRUE, C = TRUE, scores = FALSE, show.plot = TRUE,
              groups = rep(1, n), gapC = sqrt(sum(par()$cxy^2)),
              scaleA = 1,
              xlab = "Latent Variable 1", ylab = "Latent Variable 2",
              Alabels = if (length(object@misc$predictors.names))
              object@misc$predictors.names else param.names("LP", M),
              Aadj = par()$adj, Acex = par()$cex, Acol = par()$col,
              Apch = NULL,
              Clabels = rownames(Cmat), Cadj = par()$adj,
              Ccex = par()$cex, Ccol = par()$col, Clty = par()$lty,
              Clwd = par()$lwd,
              chull.arg = FALSE, ccex = par()$cex, ccol = par()$col,
              clty = par()$lty, clwd = par()$lwd,
              spch = NULL, scex = par()$cex, scol = par()$col,
              slabels = rownames(x2mat), ...)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>object</code></td>
<td>
<p> Object of class <code>"rrvglm"</code>. </p>
</td></tr>
<tr valign="top"><td><code>A</code></td>
<td>
<p> Logical. Allow the plotting of <b>A</b>? </p>
</td></tr>
<tr valign="top"><td><code>C</code></td>
<td>
<p> Logical. Allow the plotting of <b>C</b>? If <code>TRUE</code> then
<b>C</b> is represented by arrows emenating from the origin. </p>
</td></tr>
<tr valign="top"><td><code>scores</code></td>
<td>
<p> Logical. Allow the plotting of the <i>n</i> scores?
The scores are the values of the latent variables for each
observation. </p>
</td></tr>
<tr valign="top"><td><code>show.plot</code></td>
<td>
<p> Logical. Plot it? If <code>FALSE</code>, no plot is produced
and the matrix of scores (<i>n</i> latent variable values) is returned.
If <code>TRUE</code>, the rank of <code>object</code> need not be 2.
</p>
</td></tr>
<tr valign="top"><td><code>groups</code></td>
<td>
<p> A vector whose distinct values indicate which group the
observation belongs to. By default, all the observations belong to a
single group. Useful for the multinomial logit model (see
<code><a href="multinomial.html">multinomial</a></code>.</p>
</td></tr>
<tr valign="top"><td><code>gapC</code></td>
<td>
<p> The gap between the end of the arrow and the text labelling
of <b>C</b>, in latent variable units.</p>
</td></tr>
<tr valign="top"><td><code>scaleA</code></td>
<td>
<p> Numerical value that is multiplied by <b>A</b>, so that
<b>C</b> is divided by this value. </p>
</td></tr>
<tr valign="top"><td><code>xlab</code></td>
<td>
<p> Caption for the x-axis. See <code><a href="../../graphics/html/par.html">par</a></code>. </p>
</td></tr>
<tr valign="top"><td><code>ylab</code></td>
<td>
<p> Caption for the y-axis. See <code><a href="../../graphics/html/par.html">par</a></code>. </p>
</td></tr>
<tr valign="top"><td><code>Alabels</code></td>
<td>
<p> Character vector to label <b>A</b>. Must be of length
<i>M</i>. </p>
</td></tr>
<tr valign="top"><td><code>Aadj</code></td>
<td>
<p> Justification of text strings for labelling <b>A</b>.
See the <code>adj</code> argument of <code><a href="../../graphics/html/par.html">par</a></code>. </p>
</td></tr>
<tr valign="top"><td><code>Acex</code></td>
<td>
<p> Numeric. Character expansion of the labelling of <b>A</b>.
See the <code>cex</code> argument of <code><a href="../../graphics/html/par.html">par</a></code>. </p>
</td></tr>
<tr valign="top"><td><code>Acol</code></td>
<td>
<p> Line color of the arrows representing <b>C</b>.
See the <code>col</code> argument of <code><a href="../../graphics/html/par.html">par</a></code>. </p>
</td></tr>
<tr valign="top"><td><code>Apch</code></td>
<td>
<p> Either an integer specifying a symbol or a single character
to be used as the default in plotting points.
See <code><a href="../../graphics/html/par.html">par</a></code>.
The <code>pch</code> argument can be of length <i>M</i>, the number of species. </p>
</td></tr>
<tr valign="top"><td><code>Clabels</code></td>
<td>
<p> Character vector to label <b>C</b>. Must be of length
<i>p2</i>. </p>
</td></tr>
<tr valign="top"><td><code>Cadj</code></td>
<td>
<p> Justification of text strings for labelling <b>C</b>.
See the <code>adj</code> argument of <code><a href="../../graphics/html/par.html">par</a></code>. </p>
</td></tr>
<tr valign="top"><td><code>Ccex</code></td>
<td>
<p> Numeric. Character expansion of the labelling of <b>C</b>.
See the <code>cex</code> argument of <code><a href="../../graphics/html/par.html">par</a></code>. </p>
</td></tr>
<tr valign="top"><td><code>Ccol</code></td>
<td>
<p> Line color of the arrows representing <b>C</b>.
See the <code>col</code> argument of <code><a href="../../graphics/html/par.html">par</a></code>. </p>
</td></tr>
<tr valign="top"><td><code>Clty</code></td>
<td>
<p> Line type of the arrows representing <b>C</b>.
See the <code>lty</code> argument of <code><a href="../../graphics/html/par.html">par</a></code>. </p>
</td></tr>
<tr valign="top"><td><code>Clwd</code></td>
<td>
<p> Line width of the arrows representing <b>C</b>.
See the <code>lwd</code> argument of <code><a href="../../graphics/html/par.html">par</a></code>. </p>
</td></tr>
<tr valign="top"><td><code>chull.arg</code></td>
<td>
<p> Logical. Plot the convex hull of the scores? This is
done for each group (see the <code>group</code> argument). </p>
</td></tr>
<tr valign="top"><td><code>ccex</code></td>
<td>
<p> Numeric. Character expansion of the labelling of the convex hull.
See the <code>cex</code> argument of <code><a href="../../graphics/html/par.html">par</a></code>. </p>
</td></tr>
<tr valign="top"><td><code>ccol</code></td>
<td>
<p> Line color of the convex hull.
See the <code>col</code> argument of <code><a href="../../graphics/html/par.html">par</a></code>. </p>
</td></tr>
<tr valign="top"><td><code>clty</code></td>
<td>
<p> Line type of the convex hull.
See the <code>lty</code> argument of <code><a href="../../graphics/html/par.html">par</a></code>. </p>
</td></tr>
<tr valign="top"><td><code>clwd</code></td>
<td>
<p> Line width of the convex hull.
See the <code>lwd</code> argument of <code><a href="../../graphics/html/par.html">par</a></code>. </p>
</td></tr>
<tr valign="top"><td><code>spch</code></td>
<td>
<p> Either an integer specifying a symbol or a single character
to be used as the default in plotting points.
See <code><a href="../../graphics/html/par.html">par</a></code>.
The <code>spch</code> argument can be of length <i>M</i>, the number of species. </p>
</td></tr>
<tr valign="top"><td><code>scex</code></td>
<td>
<p> Numeric. Character expansion of the labelling of the scores.
See the <code>cex</code> argument of <code><a href="../../graphics/html/par.html">par</a></code>. </p>
</td></tr>
<tr valign="top"><td><code>scol</code></td>
<td>
<p> Line color of the arrows representing <b>C</b>.
See the <code>col</code> argument of <code><a href="../../graphics/html/par.html">par</a></code>. </p>
</td></tr>
<tr valign="top"><td><code>slabels</code></td>
<td>
<p> Character vector to label the scores.
Must be of length <i>n</i>. </p>
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
<p> Arguments passed into the <code>plot</code> function
when setting up the entire plot. Useful arguments here include
<code>xlim</code> and <code>ylim</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For RR-VGLMs, a <em>biplot</em> and a <em>latent variable</em> plot coincide.
In general, many of the arguments starting with
&ldquo;A&rdquo; refer to <b>A</b> (of length <i>M</i>),
&ldquo;C&rdquo; to <b>C</b> (of length <i>p2</i>),
&ldquo;c&rdquo; to the convex hull (of length <code>length(unique(groups))</code>),
and &ldquo;s&rdquo; to scores (of length <i>n</i>).
</p>
<p>As the result is a biplot, its interpretation is based on the inner
product.
</p>


<h3>Value</h3>

<p>The matrix of scores (<i>n</i> latent variable values) is returned
regardless of whether a plot was produced or not.
</p>


<h3>Note</h3>




<p>The functions <code><a href="lvplot.rrvglm.html">lvplot.rrvglm</a></code> and
<code><a href="lvplot.rrvglm.html">biplot.rrvglm</a></code> are equivalent.
</p>
<p>In the example below the predictor variables are centered, which
is a good idea.
</p>


<h3>Author(s)</h3>

<p> Thomas W. Yee </p>


<h3>References</h3>

<p>Yee, T. W. and Hastie, T. J. (2003)
Reduced-rank vector generalized linear models.
<em>Statistical Modelling</em>,
<b>3</b>, 15&ndash;41.
</p>


<h3>See Also</h3>

<p><code><a href="lvplot.html">lvplot</a></code>,
<code><a href="../../graphics/html/par.html">par</a></code>,
<code><a href="rrvglm.html">rrvglm</a></code>,
<code><a href="Coef.rrvglm.html">Coef.rrvglm</a></code>,
<code><a href="rrvglm.control.html">rrvglm.control</a></code>.
</p>


<h3>Examples</h3>

<pre>
nn &lt;- nrow(pneumo)  # x1, x2 and x3 are some unrelated covariates
pneumo &lt;- transform(pneumo, slet = scale(log(exposure.time)),
                              x1 = rnorm(nn), x2 = rnorm(nn), x3 = rnorm(nn))
fit &lt;- rrvglm(cbind(normal, mild, severe) ~ slet + x1 + x2 + x3,
              multinomial, data = pneumo, Rank = 2,
              Corner = FALSE, Uncorrel = TRUE)
## Not run: 
lvplot(fit, chull = TRUE, scores = TRUE, clty = 2, ccol = "blue",
       scol = "red", Ccol = "darkgreen", Clwd = 2, Ccex = 2,
       main = "Biplot of some fictitional data") 
## End(Not run)
</pre>

<hr /><div style="text-align: center;">[Package <em>VGAM</em> version 1.0-6 <a href="00Index.html">Index</a>]</div>
</body></html>
