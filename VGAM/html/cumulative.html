<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Ordinal Regression with Cumulative Probabilities</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for cumulative {VGAM}"><tr><td>cumulative {VGAM}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2> Ordinal Regression with Cumulative Probabilities </h2>

<h3>Description</h3>

<p>Fits a cumulative link
regression model to a (preferably ordered) factor response.
</p>


<h3>Usage</h3>

<pre>
cumulative(link = "logit", parallel = FALSE, reverse = FALSE,
           multiple.responses = FALSE, whitespace = FALSE)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>link</code></td>
<td>

<p>Link function applied to the <i>J</i> cumulative probabilities.
See <code><a href="Links.html">Links</a></code> for more choices,
e.g., for the cumulative
<code><a href="probit.html">probit</a></code>/<code><a href="cloglog.html">cloglog</a></code>/<code><a href="cauchit.html">cauchit</a></code>/...
models.
</p>
</td></tr>
</table>





<table summary="R argblock">
<tr valign="top"><td><code>parallel</code></td>
<td>

<p>A logical or formula specifying which terms have
equal/unequal coefficients.
See below for more information about the parallelism assumption.
The default results in what some people call the
<em>generalized ordered logit model</em> to be fitted.
If <code>parallel = TRUE</code> then it does not apply to the intercept.
</p>
</td></tr>
</table>








<table summary="R argblock">
<tr valign="top"><td><code>reverse</code></td>
<td>

<p>Logical.
By default, the cumulative probabilities used are
<i>P(Y&lt;=1)</i>, <i>P(Y&lt;=2)</i>,
..., <i>P(Y&lt;=J)</i>.
If <code>reverse</code> is <code>TRUE</code> then
<i>P(Y&gt;=2)</i>, <i>P(Y&gt;=3)</i>, ...,
<i>P(Y&gt;=J+1)</i> are used.
</p>
<p>This should be set to <code>TRUE</code> for <code>link=</code>
<code><a href="golf.html">golf</a></code>,
<code><a href="polf.html">polf</a></code>,
<code><a href="nbolf.html">nbolf</a></code>.
For these links the cutpoints must be an increasing sequence;
if <code>reverse = FALSE</code> for then the cutpoints must be an
decreasing sequence.
</p>
</td></tr>
<tr valign="top"><td><code>multiple.responses</code></td>
<td>

<p>Logical.
Multiple responses? If <code>TRUE</code> then the input should be
a matrix with values <i>1,2,&hellip;,L</i>, where <i>L=J+1</i> is the
number of levels.
Each column of the matrix is a response, i.e., multiple responses.
A suitable matrix can be obtained from <code>Cut</code>.
</p>
</td></tr>
</table>














<table summary="R argblock">
<tr valign="top"><td><code>whitespace</code></td>
<td>

<p>See <code><a href="CommonVGAMffArguments.html">CommonVGAMffArguments</a></code> for information.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In this help file the response <i>Y</i> is assumed to be a factor
with ordered values <i>1,2,&hellip;,J+1</i>.
Hence <i>M</i> is the number of linear/additive predictors
<i>eta_j</i>;
for <code>cumulative()</code> one has <i>M=J</i>.

</p>
<p>This <span class="pkg">VGAM</span> family function fits the class of
<em>cumulative link models</em> to (hopefully) an ordinal response.
By default, the <em>non-parallel</em> cumulative logit model is fitted, i.e.,
</p>
<p style="text-align: center;"><i>
         eta_j = logit(P[Y&lt;=j])</i></p>

<p>where <i>j=1,2,&hellip;,M</i> and
the <i>eta_j</i> are not constrained to be parallel.
This is also known as the <em>non-proportional odds model</em>.
If the logit link is replaced by a complementary log-log link
(<code><a href="cloglog.html">cloglog</a></code>) then
this is known as the <em>proportional-hazards model</em>.
</p>
<p>In almost all the literature, the constraint matrices associated
with this family of models are known. For example, setting
<code>parallel = TRUE</code> will make all constraint matrices
(except for the intercept) equal to a vector of <i>M</i> 1's.
If the constraint matrices are equal, unknown and to be estimated, then
this can be achieved by fitting the model as a
reduced-rank vector generalized
linear model (RR-VGLM; see <code><a href="rrvglm.html">rrvglm</a></code>).
Currently, reduced-rank vector generalized additive models
(RR-VGAMs) have not been implemented here.
</p>







<h3>Value</h3>

<p>An object of class <code>"vglmff"</code> (see <code><a href="vglmff-class.html">vglmff-class</a></code>).
The object is used by modelling functions such as <code><a href="vglm.html">vglm</a></code>,
and <code><a href="vgam.html">vgam</a></code>.
</p>


<h3>Warning </h3>

<p>No check is made to verify that the response is ordinal if the
response is a matrix;
see <code><a href="../../base/html/factor.html">ordered</a></code>.
</p>


<h3>Note</h3>

<p>The response should be either a matrix of counts (with row sums that
are all positive), or a factor. In both cases, the <code>y</code> slot
returned by <code><a href="vglm.html">vglm</a></code>/<code><a href="vgam.html">vgam</a></code>/<code><a href="rrvglm.html">rrvglm</a></code>
is the matrix
of counts.
The formula must contain an intercept term.
Other <span class="pkg">VGAM</span> family functions for an ordinal response include
<code><a href="acat.html">acat</a></code>,
<code><a href="cratio.html">cratio</a></code>,
<code><a href="sratio.html">sratio</a></code>.
For a nominal (unordered) factor response, the multinomial
logit model (<code><a href="multinomial.html">multinomial</a></code>) is more appropriate.
</p>
<p>With the logit link, setting <code>parallel = TRUE</code> will fit a
proportional odds model. Note that the <code>TRUE</code> here does
not apply to the intercept term.
In practice, the validity of the proportional odds assumption
needs to be checked, e.g., by a likelihood ratio test (LRT).
If acceptable on the data,
then numerical problems are less likely to occur during the fitting,
and there are less parameters. Numerical problems occur when
the linear/additive predictors cross, which results in probabilities
outside of <i>(0,1)</i>; setting <code>parallel = TRUE</code> will help avoid
this problem.
</p>
<p>Here is an example of the usage of the <code>parallel</code> argument.
If there are covariates <code>x2</code>, <code>x3</code> and <code>x4</code>, then
<code>parallel = TRUE ~ x2 + x3 -1</code> and
<code>parallel = FALSE ~ x4</code> are equivalent. This would constrain
the regression coefficients for <code>x2</code> and <code>x3</code> to be
equal; those of the intercepts and <code>x4</code> would be different.
</p>
<p>If the data is inputted in <em>long</em> format
(not <em>wide</em> format, as in <code><a href="pneumo.html">pneumo</a></code> below)
and the self-starting initial values are not good enough then
try using
<code>mustart</code>,
<code>coefstart</code> and/or
<code>etatstart</code>.
See the example below.
</p>
<p>To fit the proportional odds model one can use the
<span class="pkg">VGAM</span> family function <code><a href="propodds.html">propodds</a></code>.
Note that <code>propodds(reverse)</code> is equivalent to
<code>cumulative(parallel = TRUE, reverse = reverse)</code> (which is
equivalent to
<code>cumulative(parallel = TRUE, reverse = reverse, link = "logit")</code>).
It is for convenience only. A call to
<code>cumulative()</code> is preferred since it reminds the user
that a parallelism assumption is made, as well as being a lot
more flexible.
</p>






<h3>Author(s)</h3>

<p> Thomas W. Yee </p>


<h3>References</h3>

<p>Agresti, A. (2013)
<em>Categorical Data Analysis</em>,
3rd ed. Hoboken, NJ, USA: Wiley.
</p>
<p>Agresti, A. (2010)
<em>Analysis of Ordinal Categorical Data</em>,
2nd ed. Hoboken, NJ, USA: Wiley.
</p>
<p>Dobson, A. J. and Barnett, A. (2008)
<em>An Introduction to Generalized Linear Models</em>,
3rd ed. Boca Raton: Chapman &amp; Hall/CRC Press.
</p>
<p>McCullagh, P. and Nelder, J. A. (1989)
<em>Generalized Linear Models</em>, 2nd ed. London: Chapman &amp; Hall.
</p>
<p>Simonoff, J. S. (2003)
<em>Analyzing Categorical Data</em>,
New York: Springer-Verlag.
</p>
<p>Yee, T. W. (2010)
The <span class="pkg">VGAM</span> package for categorical data analysis.
<em>Journal of Statistical Software</em>,
<b>32</b>, 1&ndash;34.
<a href="http://www.jstatsoft.org/v32/i10/">http://www.jstatsoft.org/v32/i10/</a>.
</p>
<p>Yee, T. W. and Wild, C. J. (1996)
Vector generalized additive models.
<em>Journal of the Royal Statistical Society, Series B, Methodological</em>,
<b>58</b>, 481&ndash;493.
</p>





<h3>See Also</h3>

<p><code><a href="propodds.html">propodds</a></code>,
<code><a href="R2latvar.html">R2latvar</a></code>,
<code><a href="ordsup.html">ordsup</a></code>,
<code><a href="prplot.html">prplot</a></code>,
<code><a href="margeff.html">margeff</a></code>,
<code><a href="acat.html">acat</a></code>,
<code><a href="cratio.html">cratio</a></code>,
<code><a href="sratio.html">sratio</a></code>,
<code><a href="multinomial.html">multinomial</a></code>,
<code><a href="pneumo.html">pneumo</a></code>,
<code><a href="Links.html">Links</a></code>,
<code><a href="hdeff.html">hdeff.vglm</a></code>,
<code><a href="logit.html">logit</a></code>,
<code><a href="probit.html">probit</a></code>,
<code><a href="cloglog.html">cloglog</a></code>,
<code><a href="cauchit.html">cauchit</a></code>,
<code><a href="golf.html">golf</a></code>,
<code><a href="polf.html">polf</a></code>,
<code><a href="nbolf.html">nbolf</a></code>,
<code><a href="logistic.html">logistic1</a></code>.
</p>


<h3>Examples</h3>

<pre>
# Fit the proportional odds model, p.179, in McCullagh and Nelder (1989)
pneumo &lt;- transform(pneumo, let = log(exposure.time))
(fit &lt;- vglm(cbind(normal, mild, severe) ~ let,
             cumulative(parallel = TRUE, reverse = TRUE), data = pneumo))
depvar(fit)  # Sample proportions (good technique)
fit@y        # Sample proportions (bad technique)
weights(fit, type = "prior")  # Number of observations
coef(fit, matrix = TRUE)
constraints(fit)  # Constraint matrices
apply(fitted(fit), 1, which.max)  # Classification
apply(predict(fit, newdata = pneumo, type = "response"),
      1, which.max)  # Classification
R2latvar(fit)

# Check that the model is linear in let ----------------------
fit2 &lt;- vgam(cbind(normal, mild, severe) ~ s(let, df = 2),
             cumulative(reverse = TRUE), data = pneumo)
## Not run:  plot(fit2, se = TRUE, overlay = TRUE, lcol = 1:2, scol = 1:2) 

# Check the proportional odds assumption with a LRT ----------
(fit3 &lt;- vglm(cbind(normal, mild, severe) ~ let,
              cumulative(parallel = FALSE, reverse = TRUE), data = pneumo))
pchisq(2 * (logLik(fit3) - logLik(fit)),
       df = length(coef(fit3)) - length(coef(fit)), lower.tail = FALSE)
lrtest(fit3, fit)  # More elegant

# A factor() version of fit ----------------------------------
# This is in long format (cf. wide format above)
Nobs &lt;- round(depvar(fit) * c(weights(fit, type = "prior")))
sumNobs &lt;- colSums(Nobs)  # apply(Nobs, 2, sum)

pneumo.long &lt;-
  data.frame(symptoms = ordered(rep(rep(colnames(Nobs), nrow(Nobs)),
                                        times = c(t(Nobs))),
                                levels = colnames(Nobs)),
             let = rep(rep(with(pneumo, let), each = ncol(Nobs)),
                       times = c(t(Nobs))))
with(pneumo.long, table(let, symptoms))  # Should be same as pneumo


(fit.long1 &lt;- vglm(symptoms ~ let, data = pneumo.long, trace = TRUE,
                   cumulative(parallel = TRUE, reverse = TRUE)))
coef(fit.long1, matrix = TRUE)  # Should be as coef(fit, matrix = TRUE)
# Could try using mustart if fit.long1 failed to converge.
mymustart &lt;- matrix(sumNobs / sum(sumNobs),
                    nrow(pneumo.long), ncol(Nobs), byrow = TRUE)
fit.long2 &lt;- vglm(symptoms ~ let, mustart = mymustart,
                  cumulative(parallel = TRUE, reverse = TRUE),
                  data = pneumo.long, trace = TRUE)
coef(fit.long2, matrix = TRUE)  # Should be as coef(fit, matrix = TRUE)
</pre>

<hr /><div style="text-align: center;">[Package <em>VGAM</em> version 1.0-6 <a href="00Index.html">Index</a>]</div>
</body></html>
