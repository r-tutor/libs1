<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Generalized Gamma distribution family function</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for gengamma.stacy {VGAM}"><tr><td>gengamma.stacy {VGAM}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2> Generalized Gamma distribution family function </h2>

<h3>Description</h3>

<p>Estimation of the 3-parameter generalized gamma distribution proposed by
Stacy (1962).
</p>


<h3>Usage</h3>

<pre>
gengamma.stacy(lscale = "loge", ld = "loge", lk = "loge",
               iscale = NULL, id = NULL, ik = NULL, imethod = 1,
               gscale.mux = exp((-4:4)/2), gshape1.d = exp((-5:5)/2),
               gshape2.k = exp((-5:5)/2), probs.y = 0.3, zero = c("d", "k"))
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>lscale, ld, lk</code></td>
<td>

<p>Parameter link function applied to each of the positive parameters
<i>b</i>, <i>d</i> and <i>k</i>, respectively.
See <code><a href="Links.html">Links</a></code> for more choices.
</p>
</td></tr>
<tr valign="top"><td><code>iscale, id, ik</code></td>
<td>

<p>Initial value for <i>b</i>, <i>d</i> and <i>k</i>, respectively.
The defaults mean an initial value is determined internally for each.
</p>
</td></tr>
<tr valign="top"><td><code>gscale.mux, gshape1.d, gshape2.k</code></td>
<td>

<p>See <code><a href="CommonVGAMffArguments.html">CommonVGAMffArguments</a></code> for information.
Replaced by <code>iscale</code>, <code>id</code> etc. if given.
</p>
</td></tr>
<tr valign="top"><td><code>imethod, probs.y, zero</code></td>
<td>

<p>See <code><a href="CommonVGAMffArguments.html">CommonVGAMffArguments</a></code> for information.
</p>




</td></tr>
</table>


<h3>Details</h3>

<p>The probability density function can be written
</p>
<p style="text-align: center;"><i>
        f(y;b,d,k) = d * b^(-d*k) * y^(d*k-1) * exp(-(y/b)^d) /  gamma(k)</i></p>

<p>for scale parameter <i>b &gt; 0</i>,
and Weibull-type shape parameter <i>d &gt; 0</i>,
gamma-type shape parameter <i>k &gt; 0</i>,
and <i>y &gt; 0</i>.
The mean of <i>Y</i>
is <i>b*gamma(k+1/d)/gamma(k)</i>
(returned as the fitted values),
which equals <i>b*k</i> if <i>d=1</i>.
</p>
<p>There are many special cases, as given in Table 1 of Stacey and Mihram (1965).
In the following, the parameters are in the order <i>b,d,k</i>.
The special cases are:
Exponential       <i>f(y;b,1,1)</i>,
Gamma             <i>f(y;b,1,k)</i>,
Weibull           <i>f(y;b,d,1)</i>,
Chi Squared       <i>f(y;2,1,a/2)</i> with <i>a</i> degrees of freedom,
Chi               <i>f(y;sqrt(2),2,a/2)</i> with <i>a</i> degrees of freedom,
Half-normal       <i>f(y;sqrt(2),2,1/2)</i>,
Circular normal   <i>f(y;sqrt(2),2,1)</i>,
Spherical normal  <i>f(y;sqrt(2),2,3/2)</i>,
Rayleigh          <i>f(y;c sqrt(2),2,1)</i> where <i>c&gt;0</i>.
Also the log-normal distribution corresponds to when <code>k = Inf</code>.
</p>


<h3>Value</h3>

<p>An object of class <code>"vglmff"</code> (see <code><a href="vglmff-class.html">vglmff-class</a></code>).
The object is used by modelling functions such as <code><a href="vglm.html">vglm</a></code>,
and <code><a href="vgam.html">vgam</a></code>.
</p>


<h3>Warning </h3>

<p>Several authors have considered maximum likelihood estimation for the
generalized gamma distribution and have found that the Newton-Raphson
algorithm does not work very well and that the existence of solutions
to the log-likelihood equations is sometimes in doubt.
Although Fisher scoring is used here, it is likely that the same
problems will be encountered.
It appears that large samples
are required, for example, the estimator of <i>k</i> became asymptotically
normal only with 400 or more observations.
It is not uncommon for maximum likelihood estimates to fail to converge
even with two or three hundred observations.
With covariates, even more observations are needed to increase the
chances of convergence.
Using covariates is not advised unless the sample size is at least
a few thousand, and even if so,
modelling 1 or 2 parameters as intercept-only is a very good idea
(e.g., <code>zero = 2:3</code>).
Monitoring convergence is also a very good idea
(e.g., set <code>trace = TRUE</code>).
Half-stepping is not uncommon, and if this occurs, then the
results should be viewed with more suspicion.
</p>


<h3>Note</h3>

<p>The notation used here differs from Stacy (1962) and Prentice (1974).
Poor initial values may result in failure to converge so
if there are covariates and there are convergence problems,
try using or checking the <code>zero</code> argument (e.g., <code>zero = 2:3</code>)
or the <code>ik</code> argument
or the <code>imethod</code> argument, etc.
</p>


<h3>Author(s)</h3>

<p> T. W. Yee </p>


<h3>References</h3>

<p>Stacy, E. W. (1962)
A generalization of the gamma distribution.
<em>Annals of Mathematical Statistics</em>, <b>33</b>(3), 1187&ndash;1192.
</p>
<p>Stacy, E. W. and Mihram, G. A. (1965)
Parameter estimation for a generalized gamma distribution.
<em>Technometrics</em>, <b>7</b>, 349&ndash;358.
</p>
<p>Prentice, R. L. (1974)
A log gamma model and its maximum likelihood estimation.
<em>Biometrika</em>, <b>61</b>, 539&ndash;544.
</p>


<h3>See Also</h3>

<p><code><a href="gengammaUC.html">rgengamma.stacy</a></code>,
<code><a href="gamma1.html">gamma1</a></code>,
<code><a href="gamma2.html">gamma2</a></code>,
<code><a href="prentice74.html">prentice74</a></code>,
<code><a href="simulate.vlm.html">simulate.vlm</a></code>,
<code><a href="chisq.html">chisq</a></code>,
<code><a href="lognormal.html">lognormal</a></code>,
<code><a href="rayleigh.html">rayleigh</a></code>,
<code><a href="weibullR.html">weibullR</a></code>.
</p>


<h3>Examples</h3>

<pre>
k &lt;- exp(-1); Scale &lt;- exp(1); dd &lt;- exp(0.5); set.seed(1)
gdata &lt;- data.frame(y = rgamma(2000, shape = k, scale = Scale))
gfit &lt;- vglm(y ~ 1, gengamma.stacy, data = gdata, trace = TRUE)
coef(gfit, matrix = TRUE)
</pre>

<hr /><div style="text-align: center;">[Package <em>VGAM</em> version 1.0-6 <a href="00Index.html">Index</a>]</div>
</body></html>
