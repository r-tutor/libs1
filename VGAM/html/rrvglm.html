<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Fitting Reduced-Rank Vector Generalized Linear Models...</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for rrvglm {VGAM}"><tr><td>rrvglm {VGAM}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2> Fitting Reduced-Rank Vector Generalized Linear Models (RR-VGLMs) </h2>

<h3>Description</h3>

<p>A <em>reduced-rank vector generalized linear model</em> (RR-VGLM) is fitted.
RR-VGLMs are VGLMs but some of the constraint matrices are estimated.
In this documentation, <i>M</i> is the number of linear predictors.
</p>


<h3>Usage</h3>

<pre>
rrvglm(formula, family = stop("argument 'family' needs to be assigned"),
       data = list(), weights = NULL, subset = NULL,
       na.action = na.fail, etastart = NULL, mustart = NULL,
       coefstart = NULL, control = rrvglm.control(...), offset = NULL,
       method = "rrvglm.fit", model = FALSE, x.arg = TRUE, y.arg = TRUE,
       contrasts = NULL, constraints = NULL, extra = NULL,
       qr.arg = FALSE, smart = TRUE, ...)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>formula, family, weights</code></td>
<td>

<p>See <code><a href="vglm.html">vglm</a></code>.
</p>
</td></tr>
<tr valign="top"><td><code>data</code></td>
<td>

<p>an optional data frame containing the variables in the model.
By default the variables are taken from <code>environment(formula)</code>,
typically the environment from which <code>rrvglm</code> is called.
</p>
</td></tr>
<tr valign="top"><td><code>subset, na.action</code></td>
<td>

<p>See <code><a href="vglm.html">vglm</a></code>.
</p>
</td></tr>
<tr valign="top"><td><code>etastart, mustart, coefstart</code></td>
<td>

<p>See <code><a href="vglm.html">vglm</a></code>.
</p>
</td></tr>
<tr valign="top"><td><code>control</code></td>
<td>

<p>a list of parameters for controlling the fitting process.
See <code><a href="rrvglm.control.html">rrvglm.control</a></code> for details.
</p>
</td></tr>
<tr valign="top"><td><code>offset, model, contrasts</code></td>
<td>

<p>See <code><a href="vglm.html">vglm</a></code>.
</p>
</td></tr>
<tr valign="top"><td><code>method</code></td>
<td>

<p>the method to be used in fitting the model.
The default (and presently only) method <code>rrvglm.fit</code>
uses iteratively reweighted least squares (IRLS).
</p>
</td></tr>
<tr valign="top"><td><code>x.arg, y.arg</code></td>
<td>

<p>logical values indicating whether
the model matrix and response vector/matrix used in the fitting
process should be assigned in the <code>x</code> and <code>y</code> slots.
Note the model matrix is the LM model matrix; to get the VGLM
model matrix type <code>model.matrix(vglmfit)</code> where
<code>vglmfit</code> is a <code>vglm</code> object.
</p>
</td></tr>
<tr valign="top"><td><code>constraints</code></td>
<td>

<p>See <code><a href="vglm.html">vglm</a></code>.
</p>
</td></tr>
<tr valign="top"><td><code>extra, smart, qr.arg</code></td>
<td>

<p>See <code><a href="vglm.html">vglm</a></code>.
</p>
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>

<p>further arguments passed into <code><a href="rrvglm.control.html">rrvglm.control</a></code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The central formula is given by
</p>
<p style="text-align: center;"><i>
         eta = B_1^T x_1 + A nu</i></p>

<p>where <i>x1</i> is a vector (usually just a 1 for an intercept),
<i>x2</i> is another vector of explanatory variables, and
<i>nu = C^T x_2</i> is an <i>R</i>-vector of
latent variables.
Here, <i>eta</i> is a vector of linear predictors,
e.g., the <i>m</i>th element is
<i>eta_m = log(E[Y_m])</i> for the <i>m</i>th
Poisson response.  The matrices <i>B_1</i>, <i>A</i> and
<i>C</i> are estimated from the data, i.e., contain the
regression coefficients.  For ecologists, the central
formula represents a <em>constrained linear ordination</em>
(CLO) since it is linear in the latent variables. It
means that the response is a monotonically increasing or
decreasing function of the latent variables.
</p>
<p>For identifiability
it is common to enforce <em>corner constraints</em> on <i>A</i>:
by default, the top <i>R</i> by <i>R</i> submatrix is fixed to
be the order-<i>R</i> identity matrix and the remainder of <i>A</i>
is estimated.
</p>
<p>The underlying algorithm of RR-VGLMs is iteratively
reweighted least squares (IRLS) with an optimizing
algorithm applied within each IRLS iteration (e.g.,
alternating algorithm).
</p>
<p>In theory, any <span class="pkg">VGAM</span> family function that works for
<code><a href="vglm.html">vglm</a></code> and <code><a href="vgam.html">vgam</a></code> should work
for <code>rrvglm</code> too.
The function that actually does the work is <code>rrvglm.fit</code>;
it is <code>vglm.fit</code> with some extra code.
</p>


<h3>Value</h3>

<p>An object of class <code>"rrvglm"</code>, which has the the same
slots as a <code>"vglm"</code> object. The only difference is
that the some of the constraint matrices are estimates
rather than known. But <span class="pkg">VGAM</span> stores the models the
same internally. The slots of <code>"vglm"</code> objects are
described in <code><a href="vglm-class.html">vglm-class</a></code>.
</p>


<h3>Note</h3>

<p>The arguments of <code>rrvglm</code> are in general the same as
those of <code><a href="vglm.html">vglm</a></code> but with some extras in
<code><a href="rrvglm.control.html">rrvglm.control</a></code>.
</p>
<p>The smart prediction (<code><a href="smartpred.html">smartpred</a></code>) library
is packed with the <span class="pkg">VGAM</span> library.
</p>
<p>In an example below, a rank-1 <em>stereotype</em>
model of Anderson (1984) is fitted to some car data.
The reduced-rank regression is performed, adjusting for
two covariates. Setting a trivial constraint matrix for
the latent variable variables in <i>x2</i> avoids
a warning message when it is overwritten by a (common)
estimated constraint matrix.  It shows that German cars
tend to be more expensive than American cars, given a
car of fixed weight and width.
</p>
<p>If <code>fit &lt;- rrvglm(..., data = mydata)</code> then
<code>summary(fit)</code> requires corner constraints and no
missing values in <code>mydata</code>.  Often the estimated
variance-covariance matrix of the parameters is not
positive-definite; if this occurs, try refitting the
model with a different value for <code>Index.corner</code>.
</p>
<p>For <em>constrained quadratic ordination</em> (CQO) see
<code><a href="cqo.html">cqo</a></code> for more details about QRR-VGLMs.
</p>
<p>With multiple binary responses, one must use
<code>binomialff(multiple.responses = TRUE)</code> to indicate
that the response is a matrix with one response per column.
Otherwise, it is interpreted as a single binary response
variable.
</p>


<h3>Author(s)</h3>

<p> Thomas W. Yee </p>


<h3>References</h3>

<p>Yee, T. W. and Hastie, T. J. (2003)
Reduced-rank vector generalized linear models.
<em>Statistical Modelling</em>,
<b>3</b>, 15&ndash;41.
</p>
<p>Yee, T. W. (2004)
A new technique for maximum-likelihood
canonical Gaussian ordination.
<em>Ecological Monographs</em>,
<b>74</b>, 685&ndash;701.
</p>
<p>Anderson, J. A. (1984)
Regression and ordered categorical variables.
<em>Journal of the Royal Statistical Society, Series B, Methodological</em>,
<b>46</b>, 1&ndash;30.
</p>
<p>Yee, T. W. (2014)
Reduced-rank vector generalized linear models with two linear predictors.
<em>Computational Statistics and Data Analysis</em>,
<b>71</b>, 889&ndash;902.
</p>





<h3>See Also</h3>

<p><code><a href="rrvglm.control.html">rrvglm.control</a></code>,
<code><a href="lvplot.rrvglm.html">lvplot.rrvglm</a></code>
(same as <code><a href="lvplot.rrvglm.html">biplot.rrvglm</a></code>),
<code><a href="rrvglm-class.html">rrvglm-class</a></code>,
<code><a href="grc.html">grc</a></code>,
<code><a href="cqo.html">cqo</a></code>,
<code><a href="vglmff-class.html">vglmff-class</a></code>,
<code><a href="vglm.html">vglm</a></code>,
<code><a href="vglm-class.html">vglm-class</a></code>,
<code><a href="smartpred.html">smartpred</a></code>,
<code>rrvglm.fit</code>.
Special family functions include
<code><a href="negbinomial.html">negbinomial</a></code>
<code><a href="zipoisson.html">zipoisson</a></code>
and <code><a href="zinegbinomial.html">zinegbinomial</a></code>.
(see Yee (2014) and <span class="pkg">COZIGAM</span>).
Methods functions include
<code><a href="Coef.rrvglm.html">Coef.rrvglm</a></code>,
<code><a href="calibrate.rrvglm.html">calibrate.rrvglm</a></code>,
<code>summary.rrvglm</code>,
etc.
Data include
<code><a href="crashes.html">crashi</a></code>.
</p>




<h3>Examples</h3>

<pre>
## Not run: 
# Example 1: RR negative binomial with Var(Y) = mu + delta1 * mu^delta2
nn &lt;- 1000       # Number of observations
delta1 &lt;- 3.0    # Specify this
delta2 &lt;- 1.5    # Specify this; should be greater than unity
a21 &lt;- 2 - delta2
mydata &lt;- data.frame(x2 = runif(nn), x3 = runif(nn))
mydata &lt;- transform(mydata, mu = exp(2 + 3 * x2 + 0 * x3))
mydata &lt;- transform(mydata,
                    y2 = rnbinom(nn, mu = mu, size = (1/delta1)*mu^a21))
plot(y2 ~ x2, data = mydata, pch = "+", col = 'blue', las = 1,
     main = paste("Var(Y) = mu + ", delta1, " * mu^", delta2, sep = ""))
rrnb2 &lt;- rrvglm(y2 ~ x2 + x3, negbinomial(zero = NULL),
                data = mydata, trace = TRUE)

a21.hat &lt;- (Coef(rrnb2)@A)["loge(size)", 1]
beta11.hat &lt;- Coef(rrnb2)@B1["(Intercept)", "loge(mu)"]
beta21.hat &lt;- Coef(rrnb2)@B1["(Intercept)", "loge(size)"]
(delta1.hat &lt;- exp(a21.hat * beta11.hat - beta21.hat))
(delta2.hat &lt;- 2 - a21.hat)
# exp(a21.hat * predict(rrnb2)[1,1] - predict(rrnb2)[1,2])  # delta1.hat
summary(rrnb2)

# Obtain a 95 percent confidence interval for delta2:
se.a21.hat &lt;- sqrt(vcov(rrnb2)["I(latvar.mat)", "I(latvar.mat)"])
ci.a21 &lt;- a21.hat +  c(-1, 1) * 1.96 * se.a21.hat
(ci.delta2 &lt;- 2 - rev(ci.a21))  # The 95 percent confidence interval

Confint.rrnb(rrnb2)  # Quick way to get it

# Plot the abundances and fitted values against the latent variable
plot(y2 ~ latvar(rrnb2), data = mydata, col = "blue",
     xlab = "Latent variable", las = 1)
ooo &lt;- order(latvar(rrnb2))
lines(fitted(rrnb2)[ooo] ~ latvar(rrnb2)[ooo], col = "orange")

# Example 2: stereotype model (reduced-rank multinomial logit model)
data(car.all)
scar &lt;- subset(car.all,
               is.element(Country, c("Germany", "USA", "Japan", "Korea")))
fcols &lt;- c(13,14,18:20,22:26,29:31,33,34,36)  # These are factors
scar[, -fcols] &lt;- scale(scar[, -fcols])  # Standardize all numerical vars
ones &lt;- matrix(1, 3, 1)
clist &lt;- list("(Intercept)" = diag(3), Width = ones, Weight = ones,
              Disp. = diag(3), Tank = diag(3), Price = diag(3),
              Frt.Leg.Room = diag(3))
set.seed(111)
fit &lt;- rrvglm(Country ~ Width + Weight + Disp. + Tank +
              Price + Frt.Leg.Room,
              multinomial, data = scar, Rank = 2, trace = TRUE,
              constraints = clist, noRRR = ~ 1 + Width + Weight,
              Uncor = TRUE, Corner = FALSE, Bestof = 2)
fit@misc$deviance  # A history of the fits
Coef(fit)
biplot(fit, chull = TRUE, scores = TRUE, clty = 2, Ccex = 2,
       ccol = "blue", scol = "orange", Ccol = "darkgreen", Clwd = 2,
       main = "1=Germany, 2=Japan, 3=Korea, 4=USA")

## End(Not run)
</pre>

<hr /><div style="text-align: center;">[Package <em>VGAM</em> version 1.0-6 <a href="00Index.html">Index</a>]</div>
</body></html>
