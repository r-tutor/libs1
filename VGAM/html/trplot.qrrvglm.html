<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Trajectory plot for QRR-VGLMs</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for trplot.qrrvglm {VGAM}"><tr><td>trplot.qrrvglm {VGAM}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2> Trajectory plot for QRR-VGLMs </h2>

<h3>Description</h3>

<p>Produces a trajectory plot for
<em>quadratic reduced-rank vector generalized linear models</em>
(QRR-VGLMs).
It is only applicable for rank-1 models with argument
<code>noRRR = ~ 1</code>.
</p>


<h3>Usage</h3>

<pre>
trplot.qrrvglm(object, which.species = NULL, add = FALSE, show.plot = TRUE,
               label.sites = FALSE, sitenames = rownames(object@y),
               axes.equal = TRUE, cex = par()$cex,
               col = 1:(nos * (nos - 1)/2), log = "",
               lty = rep_len(par()$lty, nos * (nos - 1)/2),
               lwd = rep_len(par()$lwd, nos * (nos - 1)/2),
               tcol = rep_len(par()$col, nos * (nos - 1)/2),
               xlab = NULL, ylab = NULL,
               main = "", type = "b", check.ok = TRUE, ...)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>object</code></td>
<td>
<p> Object of class <code>"qrrvglm"</code>, i.e., a CQO object. </p>
</td></tr>
<tr valign="top"><td><code>which.species</code></td>
<td>
<p> Integer or character vector specifying the
species to be plotted. If integer, these are the columns of the
response matrix. If character, these must match exactly with the
species' names.
The default is to use all species.
</p>
</td></tr>
<tr valign="top"><td><code>add</code></td>
<td>
<p> Logical. Add to an existing plot? If <code>FALSE</code> (default),
a new plot is made. </p>
</td></tr>
<tr valign="top"><td><code>show.plot</code></td>
<td>
<p> Logical. Plot it? </p>
</td></tr>
<tr valign="top"><td><code>label.sites</code></td>
<td>
<p> Logical. If <code>TRUE</code>, the points on the
curves/trajectories are labelled with the <code>sitenames</code>. </p>
</td></tr>
<tr valign="top"><td><code>sitenames</code></td>
<td>
<p> Character vector. The names of the sites. </p>
</td></tr>
<tr valign="top"><td><code>axes.equal</code></td>
<td>
<p> Logical. If <code>TRUE</code>, the x- and y-axes
will be on the same scale.
</p>
</td></tr>
<tr valign="top"><td><code>cex</code></td>
<td>
<p> Character expansion of the labelling of the site names.
Used only if <code>label.sites</code> is <code>TRUE</code>.
See the <code>cex</code> argument in <code><a href="../../graphics/html/par.html">par</a></code>.
</p>
</td></tr>
<tr valign="top"><td><code>col</code></td>
<td>
<p>Color of the lines.
See the <code>col</code> argument in <code><a href="../../graphics/html/par.html">par</a></code>.
Here, <code>nos</code> is the number of species.
</p>
</td></tr>
<tr valign="top"><td><code>log</code></td>
<td>
<p> Character, specifying which (if any) of the x- and
y-axes are to be on a logarithmic scale.
See the <code>log</code> argument in <code><a href="../../graphics/html/par.html">par</a></code>.
</p>
</td></tr>
<tr valign="top"><td><code>lty</code></td>
<td>
<p>  Line type.
See the <code>lty</code> argument of <code><a href="../../graphics/html/par.html">par</a></code>.
</p>
</td></tr>
<tr valign="top"><td><code>lwd</code></td>
<td>
<p>  Line width.
See the <code>lwd</code> argument of <code><a href="../../graphics/html/par.html">par</a></code>.
</p>
</td></tr>
<tr valign="top"><td><code>tcol</code></td>
<td>
<p>Color of the text for the site names.
See the <code>col</code> argument in <code><a href="../../graphics/html/par.html">par</a></code>.
Used only if <code>label.sites</code> is <code>TRUE</code>.
</p>
</td></tr>
<tr valign="top"><td><code>xlab</code></td>
<td>
<p>Character caption for the x-axis.
By default, a suitable caption is found.
See the <code>xlab</code> argument in <code><a href="../../graphics/html/plot.html">plot</a></code>
or <code><a href="../../graphics/html/title.html">title</a></code>.
</p>
</td></tr>
<tr valign="top"><td><code>ylab</code></td>
<td>
<p>Character caption for the y-axis.
By default, a suitable caption is found.
See the <code>xlab</code> argument in <code><a href="../../graphics/html/plot.html">plot</a></code>
or <code><a href="../../graphics/html/title.html">title</a></code>.
</p>
</td></tr>
<tr valign="top"><td><code>main</code></td>
<td>
<p> Character, giving the title of the plot.
See the <code>main</code> argument in <code><a href="../../graphics/html/plot.html">plot</a></code>
or <code><a href="../../graphics/html/title.html">title</a></code>.
</p>
</td></tr>
<tr valign="top"><td><code>type</code></td>
<td>
<p> Character, giving the type of plot. A common
option is to use <code>type="l"</code> for lines only.
See the <code>type</code> argument of <code><a href="../../graphics/html/plot.html">plot</a></code>.
</p>
</td></tr>
<tr valign="top"><td><code>check.ok</code></td>
<td>
<p> Logical. Whether a check is performed to see
that <code>noRRR = ~ 1</code> was used.
It doesn't make sense to have a trace plot unless this is so.
</p>
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
<p> Arguments passed into the <code>plot</code> function
when setting up the entire plot. Useful arguments here include
<code>xlim</code> and <code>ylim</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A trajectory plot plots the fitted values of a &lsquo;second&rsquo; species
against a &lsquo;first&rsquo; species. The argument <code>which.species</code> must
therefore contain at least two species. By default, all of the
species that were fitted in <code>object</code> are plotted.
With more than a few species
the resulting plot will be very congested, and so it is recommended
that only a few species be selected for plotting.
</p>
<p>In the above, <i>M</i> is the number of species selected for plotting,
so there will be <i>M*(M-1)/2</i> curves/trajectories in total.
</p>
<p>A trajectory plot will be fitted only if <code>noRRR = ~ 1</code> because
otherwise the trajectory will not be a smooth function of the latent
variables.
</p>


<h3>Value</h3>

<p>A list with the following components.
</p>
<table summary="R valueblock">
<tr valign="top"><td><code>species.names</code></td>
<td>

<p>A matrix of characters giving the &lsquo;first&rsquo; and &lsquo;second&rsquo; species. The
number of different combinations of species is given by the number
of rows.  This is useful for creating a legend.
</p>
</td></tr>
<tr valign="top"><td><code>sitenames</code></td>
<td>
<p>A character vector of site names, sorted by
the latent variable (from low to high).
</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Plotting the axes on a log scale is often a good idea.
The use of <code>xlim</code> and <code>ylim</code> to control the axis limits
is also a good idea, so as to limit the extent of the curves at low
abundances or probabilities.
Setting <code>label.sites = TRUE</code> is a good idea only if the number of
sites is small, otherwise there is too much clutter.
</p>


<h3>Author(s)</h3>

<p> Thomas W. Yee </p>


<h3>References</h3>

<p>Yee, T. W. (2012)
On constrained and unconstrained
quadratic ordination.
<em>Manuscript in preparation</em>.
</p>


<h3>See Also</h3>

<p><code><a href="cqo.html">cqo</a></code>,
<code><a href="../../graphics/html/par.html">par</a></code>,
<code><a href="../../graphics/html/title.html">title</a></code>.
</p>


<h3>Examples</h3>

<pre>## Not run:  set.seed(111)  # This leads to the global solution
# hspider[,1:6] &lt;- scale(hspider[,1:6])  # Standardize the environmental variables
p1 &lt;- cqo(cbind(Alopacce, Alopcune, Alopfabr, Arctlute, Arctperi, Auloalbi,
                Pardlugu, Pardmont, Pardnigr, Pardpull, Trocterr, Zoraspin) ~
          WaterCon + BareSand + FallTwig + CoveMoss + CoveHerb + ReflLux,
          poissonff, data = hspider, trace = FALSE)

trplot(p1, which.species = 1:3, log = "xy", type = "b", lty = 1,
       main = "Trajectory plot of three hunting spiders species",
       col = c("blue","red","green"), lwd = 2, label = TRUE) -&gt; ii
legend(0.00005, 0.3, lwd = 2, lty = 1, col = c("blue", "red", "green"),
       with(ii, paste(species.names[,1], species.names[,2], sep = " and ")))
abline(a = 0, b = 1, lty = "dashed", col = "grey")  # Useful reference line

## End(Not run)
</pre>

<hr /><div style="text-align: center;">[Package <em>VGAM</em> version 1.0-6 <a href="00Index.html">Index</a>]</div>
</body></html>
