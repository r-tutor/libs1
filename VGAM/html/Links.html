<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Link functions for VGLM/VGAM/etc. families</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for Links {VGAM}"><tr><td>Links {VGAM}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Link functions for VGLM/VGAM/etc. families</h2>

<h3>Description</h3>

<p>The <span class="pkg">VGAM</span> package provides a number of (parameter) link functions
which are described in general here. Collectively, they offer the user
considerable choice and flexibility for modelling data.
</p>


<h3>Usage</h3>

<pre>
TypicalVGAMlink(theta, someParameter = 0, bvalue = NULL, inverse = FALSE,
                deriv = 0, short = TRUE, tag = FALSE)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>theta</code></td>
<td>

<p>Numeric or character.
This is usually <i>theta</i> (default) but can sometimes
be <i>eta</i>,
depending on the other arguments.
If <code>theta</code> is character then <code>inverse</code> and
<code>deriv</code> are ignored.
The name <code>theta</code> should always be the name of the first argument.
</p>
</td></tr>
<tr valign="top"><td><code>someParameter</code></td>
<td>

<p>Some parameter, e.g., an offset.
</p>
</td></tr>
<tr valign="top"><td><code>bvalue</code></td>
<td>

<p>Boundary value, positive if given.
If <code>0 &lt; theta</code> then
values of <code>theta</code> which are less than or equal to 0 can be
replaced by <code>bvalue</code>
before computing the link function value.
Values of <code>theta</code> which are greater than or equal to 1 can be
replaced by 1 minus <code>bvalue</code>
before computing the link function value.
The value <code>bvalue = .Machine$double.eps</code> is sometimes a reasonable
value, or something slightly higher.
</p>
</td></tr>
</table>




















<table summary="R argblock">
<tr valign="top"><td><code>inverse</code></td>
<td>

<p>Logical. If <code>TRUE</code> and <code>deriv = 0</code>  then
the inverse link value
<i>theta</i> is returned, hence the argument
<code>theta</code> is really <i>eta</i>.
In all other cases, the argument <code>theta</code> is
really <i>theta</i>.
</p>
</td></tr>
<tr valign="top"><td><code>deriv</code></td>
<td>

<p>Integer.
Either 0, 1, or 2, specifying the order of the derivative.
Some link functions handle values up to 3 or 4.
</p>
</td></tr>
<tr valign="top"><td><code>short, tag</code></td>
<td>

<p>Logical.
These are used for labelling the <code>blurb</code> slot of a
<code><a href="vglmff-class.html">vglmff-class</a></code> object.
These arguments are used only if <code>theta</code> is character,
and gives the formula for the link in character form.
If <code>tag = TRUE</code> then the result is preceeded by a little
more information.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Almost all <span class="pkg">VGAM</span> link functions have something similar to
the argument list as given above.
In this help file we have <i>eta = g(theta)</i>
where <i>g</i> is the link function, <i>theta</i> is the
parameter and <i>eta</i> is the linear/additive predictor.
The link <i>g</i> must be strictly monotonic and
twice-differentiable in its range.
</p>



<p>The following is a brief enumeration of all <span class="pkg">VGAM</span> link functions.
</p>
<p>For parameters lying between 0 and 1 (e.g., probabilities):
<code><a href="logit.html">logit</a></code>,
<code><a href="probit.html">probit</a></code>,
<code><a href="cloglog.html">cloglog</a></code>,
<code><a href="cauchit.html">cauchit</a></code>,
<code><a href="foldsqrt.html">foldsqrt</a></code>,
<code><a href="logc.html">logc</a></code>,
<code><a href="golf.html">golf</a></code>,
<code><a href="polf.html">polf</a></code>,
<code><a href="nbolf.html">nbolf</a></code>.
</p>
<p>For positive parameters (i.e., greater than 0):
<code><a href="loge.html">loge</a></code>,
<code><a href="loge.html">negloge</a></code>,
<code><a href="powerlink.html">powerlink</a></code>.
</p>
<p>For parameters greater than 1:
<code><a href="loglog.html">loglog</a></code>.
</p>
<p>For parameters between <i>-1</i> and <i>1</i>:
<code><a href="fisherz.html">fisherz</a></code>,
<code><a href="rhobit.html">rhobit</a></code>.
</p>
<p>For parameters between <i>A</i> and <i>B</i>:
<code><a href="logit.html">extlogit</a></code>,
<code><a href="logoff.html">logoff</a></code> (<i>B = Inf</i>).
</p>
<p>For unrestricted parameters (i.e., any value):
<code><a href="../../base/html/identity.html">identity</a></code>,
<code><a href="identitylink.html">negidentity</a></code>,
<code><a href="reciprocal.html">reciprocal</a></code>,
<code><a href="reciprocal.html">negreciprocal</a></code>.
</p>



<h3>Value</h3>

<p>Returns one of:
the link function value or its first or second derivative,
the inverse link or its first or second derivative,
or a character description of the link.
</p>
<p>Here are the general details.
If <code>inverse = FALSE</code> and <code>deriv = 0</code> (default) then the
ordinary link
function <i>eta = g(theta)</i> is returned.
</p>
<p>If <code>inverse = TRUE</code> and <code>deriv = 0</code> then the inverse
link function value is returned, hence <code>theta</code> is really
<i>eta</i> (the only occasion this happens).
</p>
<p>If <code>inverse = FALSE</code> and <code>deriv = 1</code> then it is
<i>d eta / d theta</i>
<em>as a function of</em> <i>theta</i>.
If <code>inverse = FALSE</code> and <code>deriv = 2</code> then it is
<i>d^2 eta / d theta^2</i>
<em>as a function of</em> <i>theta</i>.
</p>
<p>If <code>inverse = TRUE</code> and <code>deriv = 1</code> then it is
<i>d theta / d eta</i>
<em>as a function of</em> <i>theta</i>.
If <code>inverse = TRUE</code> and <code>deriv = 2</code> then it is
<i>d^2 theta / d eta^2</i>
<em>as a function of</em> <i>theta</i>.
</p>
<p>It is only when <code>deriv = 1</code> that
<code>linkfun(theta, deriv = 1, inverse = TRUE)</code>
and
<code>linkfun(theta, deriv = 1, inverse = FALSE)</code>
are <em>reciprocals</em> of each other.
In particular,
<code>linkfun(theta, deriv = 2, inverse = TRUE)</code>
and
<code>linkfun(theta, deriv = 2, inverse = FALSE)</code>
are <em>not</em> reciprocals of each other in general.
</p>
















<h3>Warning </h3>

<p>The output of link functions changed at <span class="pkg">VGAM</span> <code>0.9-9</code>
(date was around 2015-07).
Formerly, <code>linkfun(theta, deriv = 1)</code> is now
<code>linkfun(theta, deriv = 1, inverse = TRUE)</code>, or equivalently,
<code>1 / linkfun(theta, deriv = 1, inverse = TRUE)</code>.
Also, formerly, <code>linkfun(theta, deriv = 2)</code> was
<code>1 / linkfun(theta, deriv = 2, inverse = TRUE)</code>.
This was a bug.
Altogether, these are big changes and the user should beware!
</p>
<p>One day in the future, <em>all</em> <span class="pkg">VGAM</span> link functions
may be renamed to end in the characters <code>"link"</code>.
</p>


<h3>Note</h3>

<p><span class="pkg">VGAM</span> link functions are generally not compatible with other functions
outside the package.
In particular, they won't work with
<code><a href="../../stats/html/glm.html">glm</a></code> or any other package for fitting GAMs.
</p>
<p>From October 2006 onwards,
all <span class="pkg">VGAM</span> family functions will only
contain one default value for each link argument rather than giving a
vector of choices.
For example, rather than
<code>binomialff(link = c("logit", "probit", "cloglog",
  "cauchit", "identitylink"), ...)</code>
it is now
<code>binomialff(link = "logit", ...)</code>.
No checking will be done to see if the user's choice is reasonable.
This means that the user can write his/her own <span class="pkg">VGAM</span> link function
and use it within any <span class="pkg">VGAM</span> family function.
Altogether this provides greater flexibility.
The downside is that the user must specify the <em>full</em> name of the
link function, by either assigning the link argument the full name as
a character string, or just the name itself.  See the examples below.
</p>
<p>From August 2012 onwards, a major change in link functions occurred.
Argument <code>esigma</code> (and the like such as <code>earg</code>)
used to be in <span class="pkg">VGAM</span> prior to version 0.9-0 (released
during the 2nd half of 2012).
The major change is that arguments such as <code>offset</code> that used to
be passed in via those arguments can done directly through
the link function. For example,
<code>gev(lshape = "logoff", eshape = list(offset = 0.5))</code>
is replaced by
<code>gev(lshape = logoff(offset = 0.5))</code>.
The <code>@misc</code> slot no longer
has <code>link</code> and <code>earg</code> components, but two other
components replace these. Functions such as
<code>dtheta.deta()</code>,
<code>d2theta.deta2()</code>,
<code>d3theta.deta3()</code>,
<code>eta2theta()</code>,
<code>theta2eta()</code>
are modified.
</p>


<h3>Author(s)</h3>

<p>T. W. Yee</p>


<h3>References</h3>

<p>McCullagh, P. and Nelder, J. A. (1989)
<em>Generalized Linear Models</em>, 2nd ed. London: Chapman &amp; Hall.
</p>


<h3>See Also</h3>

<p><code><a href="CommonVGAMffArguments.html">TypicalVGAMfamilyFunction</a></code>,
<code><a href="linkfun.html">linkfun</a></code>,
<code><a href="vglm.html">vglm</a></code>,
<code><a href="vgam.html">vgam</a></code>,
<code><a href="rrvglm.html">rrvglm</a></code>.
<code><a href="cqo.html">cqo</a></code>,
<code><a href="cao.html">cao</a></code>.
</p>



<h3>Examples</h3>

<pre>
logit("a")
logit("a", short = FALSE)
logit("a", short = FALSE, tag = TRUE)

logoff(1:5, offset = 1)  # Same as log(1:5 + 1)
powerlink(1:5, power = 2)  # Same as (1:5)^2

## Not run:  # This is old and no longer works:
logoff(1:5, earg = list(offset = 1))
powerlink(1:5, earg = list(power = 2))

## End(Not run)

fit1 &lt;- vgam(agaaus ~ altitude, binomialff(link = "cloglog"), hunua)  # best
fit2 &lt;- vgam(agaaus ~ altitude, binomialff(link =  cloglog ), hunua)  # okay

## Not run: 
# This no longer works since "clog" is not a valid VGAM link function:
fit3 &lt;- vgam(agaaus ~ altitude, binomialff(link = "clog"), hunua)  # not okay


# No matter what the link, the estimated var-cov matrix is the same
y &lt;- rbeta(n = 1000, shape1 = exp(0), shape2 = exp(1))
fit1 &lt;- vglm(y ~ 1, betaR(lshape1 = "identitylink", lshape2 = "identitylink"),
             trace = TRUE, crit = "coef")
fit2 &lt;- vglm(y ~ 1, betaR(lshape1 = logoff(offset = 1.1),
                          lshape2 = logoff(offset = 1.1)), trace = TRUE)
vcov(fit1, untransform = TRUE)
vcov(fit1, untransform = TRUE) - vcov(fit2, untransform = TRUE)  # Should be all 0s
\dontrun{ # This is old:
fit1@misc$earg  # Some 'special' parameters
fit2@misc$earg  # Some 'special' parameters are here
}


par(mfrow = c(2, 2))
p &lt;- seq(0.05, 0.95, len = 200)  # A rather restricted range
x &lt;- seq(-4, 4, len = 200)
plot(p, logit(p), type = "l", col = "blue")
plot(x, logit(x, inverse = TRUE), type = "l", col = "blue")
plot(p, logit(p, deriv = 1), type = "l", col = "blue")  # 1 / (p*(1-p))
plot(p, logit(p, deriv = 2), type = "l", col = "blue")  # (2*p-1)/(p*(1-p))^2

## End(Not run)
</pre>

<hr /><div style="text-align: center;">[Package <em>VGAM</em> version 1.0-6 <a href="00Index.html">Index</a>]</div>
</body></html>
