<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Asymmetric Least Squares Quantile Regression</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for amlnormal {VGAM}"><tr><td>amlnormal {VGAM}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2> Asymmetric Least Squares Quantile Regression </h2>

<h3>Description</h3>

<p>Asymmetric least squares,
a special case of maximizing an asymmetric
likelihood function of a normal distribution.
This allows for expectile/quantile regression using asymmetric least
squares error loss.
</p>


<h3>Usage</h3>

<pre>
amlnormal(w.aml = 1, parallel = FALSE, lexpectile = "identitylink",
          iexpectile = NULL, imethod = 1, digw = 4)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>w.aml</code></td>
<td>

<p>Numeric, a vector of positive constants controlling the percentiles.
The larger the value the larger the fitted percentile value
(the proportion of points below the &ldquo;w-regression plane&rdquo;).
The default value of unity results in the ordinary least squares
(OLS) solution.
</p>
</td></tr>
<tr valign="top"><td><code>parallel</code></td>
<td>

<p>If <code>w.aml</code> has more than one value then
this argument allows the quantile curves to differ by the same amount
as a function of the covariates.
Setting this to be <code>TRUE</code> should force the quantile curves to
not cross (although they may not cross anyway).
See <code><a href="CommonVGAMffArguments.html">CommonVGAMffArguments</a></code> for more information.
</p>
</td></tr>
<tr valign="top"><td><code>lexpectile, iexpectile</code></td>
<td>

<p>See <code><a href="CommonVGAMffArguments.html">CommonVGAMffArguments</a></code> for more information.
</p>
</td></tr>
<tr valign="top"><td><code>imethod</code></td>
<td>

<p>Integer, either 1 or 2 or 3. Initialization method.
Choose another value if convergence fails.
</p>
</td></tr>
<tr valign="top"><td><code>digw </code></td>
<td>

<p>Passed into <code><a href="../../base/html/Round.html">Round</a></code> as the <code>digits</code> argument
for the <code>w.aml</code> values;
used cosmetically for labelling.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is an implementation of Efron (1991) and full details can
be obtained there.
Equation numbers below refer to that article.
The model is essentially a linear model
(see <code><a href="../../stats/html/lm.html">lm</a></code>), however,
the asymmetric squared error loss function for a residual
<i>r</i> is <i>r^2</i> if <i>r &lt;= 0</i> and
<i>w*r^2</i> if <i>r &gt; 0</i>.
The solution is the set of regression coefficients that
minimize the sum of these over the data set, weighted by the
<code>weights</code> argument (so that it can contain frequencies).
Newton-Raphson estimation is used here.
</p>


<h3>Value</h3>

<p>An object of class <code>"vglmff"</code> (see <code><a href="vglmff-class.html">vglmff-class</a></code>).
The object is used by modelling functions such as <code><a href="vglm.html">vglm</a></code>
and <code><a href="vgam.html">vgam</a></code>.
</p>


<h3>Note</h3>

<p>On fitting, the <code>extra</code> slot has list components <code>"w.aml"</code> and
<code>"percentile"</code>. The latter is the percent of observations below
the &ldquo;w-regression plane&rdquo;, which is the fitted values.
</p>
<p>One difficulty is finding the <code>w.aml</code> value giving a specified
percentile. One solution is to fit the model within a root finding
function such as <code><a href="../../stats/html/uniroot.html">uniroot</a></code>; see the example below.
</p>
<p>For <code>amlnormal</code> objects, methods functions for the generic functions
<code>qtplot</code> and <code>cdf</code> have not been written yet.
</p>
<p>See the note in <code><a href="amlpoisson.html">amlpoisson</a></code> on the jargon, including
<em>expectiles</em> and <em>regression quantiles</em>.
</p>
<p>The <code>deviance</code> slot computes the total asymmetric squared error
loss (2.5).
If <code>w.aml</code> has more than one value then the value returned by
the slot is the sum taken over all the <code>w.aml</code> values.
</p>
<p>This <span class="pkg">VGAM</span> family function could well be renamed <code>amlnormal()</code>
instead, given the other function names <code><a href="amlpoisson.html">amlpoisson</a></code>,
<code><a href="amlbinomial.html">amlbinomial</a></code>, etc.
</p>
<p>In this documentation the word <em>quantile</em> can often be
interchangeably replaced by <em>expectile</em>
(things are informal here).
</p>


<h3>Author(s)</h3>

<p> Thomas W. Yee </p>


<h3>References</h3>

<p>Efron, B. (1991)
Regression percentiles using asymmetric squared error loss.
<em>Statistica Sinica</em>,
<b>1</b>, 93&ndash;125.
</p>


<h3>See Also</h3>

<p><code><a href="amlpoisson.html">amlpoisson</a></code>,
<code><a href="amlbinomial.html">amlbinomial</a></code>,
<code><a href="amlexponential.html">amlexponential</a></code>,
<code><a href="bmi.nz.html">bmi.nz</a></code>,
<code><a href="alaplace3.html">alaplace1</a></code>,
<code><a href="enormUC.html">denorm</a></code>,
<code><a href="lms.bcn.html">lms.bcn</a></code> and similar variants are alternative
methods for quantile regression.
</p>


<h3>Examples</h3>

<pre>
## Not run: 
# Example 1
ooo &lt;- with(bmi.nz, order(age))
bmi.nz &lt;- bmi.nz[ooo, ]  # Sort by age
(fit &lt;- vglm(BMI ~ sm.bs(age), amlnormal(w.aml = 0.1), data = bmi.nz))
fit@extra  # Gives the w value and the percentile
coef(fit, matrix = TRUE)

# Quantile plot
with(bmi.nz, plot(age, BMI, col = "blue", main =
     paste(round(fit@extra$percentile, digits = 1),
           "expectile-percentile curve")))
with(bmi.nz, lines(age, c(fitted(fit)), col = "black"))

# Example 2
# Find the w values that give the 25, 50 and 75 percentiles
find.w &lt;- function(w, percentile = 50) {
  fit2 &lt;- vglm(BMI ~ sm.bs(age), amlnormal(w = w), data = bmi.nz)
  fit2@extra$percentile - percentile
}
# Quantile plot
with(bmi.nz, plot(age, BMI, col = "blue", las = 1, main =
     "25, 50 and 75 expectile-percentile curves"))
for (myp in c(25, 50, 75)) {
# Note: uniroot() can only find one root at a time
  bestw &lt;- uniroot(f = find.w, interval = c(1/10^4, 10^4), percentile = myp)
  fit2 &lt;- vglm(BMI ~ sm.bs(age), amlnormal(w = bestw$root), data = bmi.nz)
  with(bmi.nz, lines(age, c(fitted(fit2)), col = "orange"))
}

# Example 3; this is Example 1 but with smoothing splines and
# a vector w and a parallelism assumption.
ooo &lt;- with(bmi.nz, order(age))
bmi.nz &lt;- bmi.nz[ooo, ]  # Sort by age
fit3 &lt;- vgam(BMI ~ s(age, df = 4), data = bmi.nz, trace = TRUE,
             amlnormal(w = c(0.1, 1, 10), parallel = TRUE))
fit3@extra  # The w values, percentiles and weighted deviances

# The linear components of the fit; not for human consumption:
coef(fit3, matrix = TRUE)

# Quantile plot
with(bmi.nz, plot(age, BMI, col="blue", main =
     paste(paste(round(fit3@extra$percentile, digits = 1), collapse = ", "),
           "expectile-percentile curves")))
with(bmi.nz, matlines(age, fitted(fit3), col = 1:fit3@extra$M, lwd = 2))
with(bmi.nz, lines(age, c(fitted(fit )), col = "black"))  # For comparison

## End(Not run)
</pre>

<hr /><div style="text-align: center;">[Package <em>VGAM</em> version 1.0-6 <a href="00Index.html">Index</a>]</div>
</body></html>
