<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: User callbacks on mouse events</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for rgl.setMouseCallbacks {rgl}"><tr><td>rgl.setMouseCallbacks {rgl}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2> User callbacks on mouse events </h2>

<h3>Description</h3>

<p>Set and get user callbacks on mouse events.
</p>


<h3>Usage</h3>

<pre>
rgl.setMouseCallbacks(button, begin = NULL, update = NULL, end = NULL)
rgl.getMouseCallbacks(button)
rgl.setWheelCallback(rotate)
rgl.getWheelCallback()
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>button</code></td>
<td>
<p> Which button?  </p>
</td></tr>
<tr valign="top"><td><code>begin</code></td>
<td>
<p> Called when mouse down event occurs </p>
</td></tr>
<tr valign="top"><td><code>update</code></td>
<td>
<p> Called when mouse moves </p>
</td></tr>
<tr valign="top"><td><code>end</code></td>
<td>
<p> Called when mouse is released </p>
</td></tr>
<tr valign="top"><td><code>rotate</code></td>
<td>
<p> Called when mouse wheel is rotated </p>
</td></tr>
</table>


<h3>Details</h3>

<p>The set functions set event handlers on mouse events that occur within the current rgl window.
The <code>begin</code> and <code>update</code> events should be functions taking two arguments; these
will be the mouse coordinates when the event occurs.  The <code>end</code> event handler
takes no arguments.  The <code>rotate</code> event takes a single argument, which will be 
equal to <code>1</code> if the user pushes the wheel away by one click, and <code>2</code> if 
the user pulls the wheel by one click.
</p>
<p>Alternatively, the handlers may be set to <code>NULL</code>, the default value, in which case
no action will occur.
</p>
<p>If a subscene has multiple listeners, the user action will still only be called for the
subscene that received the mouse event.  It should consult <code><a href="par3d.html">par3d</a>("listeners")</code>
if it makes sense to take action on the whole group of subscenes.
</p>
<p>The get function retrieves the callbacks that are currently set.
</p>


<h3>Value</h3>

<p>The set functions are called for the side effect of setting the mouse event handlers.
</p>
<p>The <code>rgl.getMouseCallbacks</code> function returns a list containing the callback functions or <code>NULL</code> if no user callback is set.
The <code>rgl.getWheelCallback</code> returns the callback function or <code>NULL</code>.
</p>


<h3>Author(s)</h3>

<p> Duncan Murdoch </p>


<h3>See Also</h3>

 <p><code><a href="par3d.html">par3d</a></code> to set built-in handlers </p>


<h3>Examples</h3>

<pre>

## Not quite right --- this doesn't play well with rescaling

 pan3d &lt;- function(button) {
   start &lt;- list()
   
   begin &lt;- function(x, y) {
       start$userMatrix &lt;&lt;- par3d("userMatrix")
       start$viewport &lt;&lt;- par3d("viewport")
       start$scale &lt;&lt;- par3d("scale")
       start$projection &lt;&lt;- rgl.projection()
       start$pos &lt;&lt;- rgl.window2user( x/start$viewport[3], 1 - y/start$viewport[4], 0.5, 
                                      projection = start$projection)
   }
   
   update &lt;- function(x, y) {
        xlat &lt;- (rgl.window2user( x/start$viewport[3], 1 - y/start$viewport[4], 0.5,
                                 projection = start$projection) - start$pos)*start$scale
        mouseMatrix &lt;- translationMatrix(xlat[1], xlat[2], xlat[3])
        par3d(userMatrix = start$userMatrix %*% t(mouseMatrix) )
   }
   rgl.setMouseCallbacks(button, begin, update)
   cat("Callbacks set on button", button, "of rgl device", rgl.cur(), "\n")
 }
 shade3d(icosahedron3d(), col = "yellow")
 pan3d(3)
</pre>

<hr /><div style="text-align: center;">[Package <em>rgl</em> version 0.98.22 <a href="00Index.html">Index</a>]</div>
</body></html>
